{"ast":null,"code":"\"use strict\";var _defineProperty=require(\"@babel/runtime/helpers/defineProperty\");var _objectWithoutProperties=require(\"@babel/runtime/helpers/objectWithoutProperties\");var _excluded=[\"source\"],_excluded2=[\"onDocumentMetadataLoaded\",\"onTTreeChange\",\"contentWidth\"],_excluded3=[\"source\"],_excluded4=[\"source\"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=exports.renderSourcePropTypes=void 0;var _equals=_interopRequireDefault(require(\"ramda/src/equals\"));var _react=_interopRequireWildcard(require(\"react\"));var _reactNative=require(\"react-native-web/dist/index\");var _propTypes=_interopRequireDefault(require(\"prop-types\"));var _ttreeEventsContext=_interopRequireDefault(require(\"./context/ttreeEventsContext\"));var _isUriSource=_interopRequireDefault(require(\"./helpers/isUriSource\"));var _SourceLoaderUri=_interopRequireDefault(require(\"./SourceLoaderUri\"));var _SourceLoaderInline=_interopRequireDefault(require(\"./SourceLoaderInline\"));var _SourceLoaderDom=_interopRequireDefault(require(\"./SourceLoaderDom\"));var _debugMessages=_interopRequireDefault(require(\"./debugMessages\"));var _contentWidthContext=_interopRequireDefault(require(\"./context/contentWidthContext\"));var _isDomSource=_interopRequireDefault(require(\"./helpers/isDomSource\"));var _useProfiler=_interopRequireDefault(require(\"./hooks/useProfiler\"));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!==\"function\")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!==\"object\"&&typeof obj!==\"function\"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!==\"default\"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var renderSourcePropTypes={source:_propTypes.default.oneOfType([_propTypes.default.shape({html:_propTypes.default.string.isRequired,baseUrl:_propTypes.default.string}),_propTypes.default.shape({dom:_propTypes.default.object.isRequired,baseUrl:_propTypes.default.string}),_propTypes.default.shape({uri:_propTypes.default.string.isRequired,method:_propTypes.default.string,body:_propTypes.default.any,headers:_propTypes.default.object})]),onTTreeChange:_propTypes.default.func,onHTMLLoaded:_propTypes.default.func,onDocumentMetadataLoaded:_propTypes.default.func,contentWidth:_propTypes.default.number};exports.renderSourcePropTypes=renderSourcePropTypes;function isEmptySource(source){return!source||typeof source.uri!=='string'&&typeof source.html!=='string'&&!source.dom;}function RawSourceLoader(_ref){var source=_ref.source,props=_objectWithoutProperties(_ref,_excluded);if(isEmptySource(source)){if(typeof __DEV__==='boolean'&&__DEV__){console.warn(_debugMessages.default.noSource);}return null;}if((0,_isUriSource.default)(source)){return _react.default.createElement(_SourceLoaderUri.default,_objectSpread({source:source},props));}if((0,_isDomSource.default)(source)){return _react.default.createElement(_SourceLoaderDom.default,_objectSpread({source:source},props));}return _react.default.createElement(_SourceLoaderInline.default,_objectSpread({source:source},props));}function shallowEqual(prop1,prop2){if(!(0,_equals.default)(Object.keys(prop1),Object.keys(prop2))){return false;}for(var key in prop1){if(prop1[key]!==prop2[key]){return false;}}return true;}var RenderHTMLSource=(0,_react.memo)(function RenderHtmlSource(_ref2){var onDocumentMetadataLoaded=_ref2.onDocumentMetadataLoaded,onTTreeChange=_ref2.onTTreeChange,contentWidth=_ref2.contentWidth,props=_objectWithoutProperties(_ref2,_excluded2);var profile=(0,_useProfiler.default)({prop:'onDocumentMetadataLoaded or onTTreeChange'});var ttreeEvents=(0,_react.useMemo)(function(){typeof __DEV__==='boolean'&&__DEV__&&profile();return{onDocumentMetadataLoaded:onDocumentMetadataLoaded,onTTreeChange:onTTreeChange};},[onDocumentMetadataLoaded,onTTreeChange,profile]);if(typeof __DEV__==='boolean'&&__DEV__){if(!(typeof contentWidth==='number')){console.warn(_debugMessages.default.contentWidth);}}return _react.default.createElement(_ttreeEventsContext.default.Provider,{value:ttreeEvents},_react.default.createElement(_contentWidthContext.default.Provider,{value:contentWidth||_reactNative.Dimensions.get('window').width},_react.default.createElement(RawSourceLoader,props)));},function(_ref3,_ref4){var prevSource=_ref3.source,prev=_objectWithoutProperties(_ref3,_excluded3);var currSource=_ref4.source,curr=_objectWithoutProperties(_ref4,_excluded4);return shallowEqual(prevSource,currSource)&&shallowEqual(prev,curr);});RenderHTMLSource.propTypes=renderSourcePropTypes;var _default=RenderHTMLSource;exports.default=_default;","map":{"version":3,"sources":["RenderHTMLSource.tsx"],"names":["renderSourcePropTypes","source","html","PropTypes","baseUrl","string","dom","uri","method","body","headers","object","onTTreeChange","onHTMLLoaded","onDocumentMetadataLoaded","contentWidth","number","props","isEmptySource","console","debugMessage","SourceLoaderUri","SourceLoaderDom","SourceLoaderInline","Object","prop1","prop2","RenderHTMLSource","profile","prop","ttreeEvents","Dimensions","width","React","prev","curr","shallowEqual"],"mappings":"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","sourcesContent":["import equals from 'ramda/src/equals';\nimport React, { memo, ReactElement, useMemo } from 'react';\nimport { Dimensions } from 'react-native';\nimport PropTypes from 'prop-types';\nimport ttreeEventsContext from './context/ttreeEventsContext';\nimport isUriSource from './helpers/isUriSource';\nimport { SourceLoaderProps, TTreeEvents } from './internal-types';\nimport {\n  HTMLSourceDom,\n  HTMLSourceInline,\n  RenderHTMLSourceProps,\n  HTMLSourceUri,\n  HTMLSource\n} from './shared-types';\nimport SourceLoaderUri from './SourceLoaderUri';\nimport SourceLoaderInline from './SourceLoaderInline';\nimport SourceLoaderDom from './SourceLoaderDom';\nimport debugMessage from './debugMessages';\nimport contentWidthContext from './context/contentWidthContext';\nimport isDomSource from './helpers/isDomSource';\nimport useProfiler from './hooks/useProfiler';\n\nexport type RenderHTMLSourcePropTypes = Record<\n  keyof RenderHTMLSourceProps,\n  any\n>;\n\nexport const renderSourcePropTypes: RenderHTMLSourcePropTypes = {\n  source: PropTypes.oneOfType([\n    PropTypes.shape({\n      html: PropTypes.string.isRequired,\n      baseUrl: PropTypes.string\n    }),\n    PropTypes.shape({\n      dom: PropTypes.object.isRequired,\n      baseUrl: PropTypes.string\n    }),\n    PropTypes.shape({\n      uri: PropTypes.string.isRequired,\n      method: PropTypes.string,\n      body: PropTypes.any,\n      headers: PropTypes.object\n    })\n  ]),\n  onTTreeChange: PropTypes.func,\n  onHTMLLoaded: PropTypes.func,\n  onDocumentMetadataLoaded: PropTypes.func,\n  contentWidth: PropTypes.number\n};\n\nfunction isEmptySource(source: undefined | HTMLSource) {\n  return (\n    !source ||\n    (typeof (source as HTMLSourceUri).uri !== 'string' &&\n      typeof (source as HTMLSourceInline).html !== 'string' &&\n      !(source as HTMLSourceDom).dom)\n  );\n}\n\nfunction RawSourceLoader({\n  source,\n  ...props\n}: SourceLoaderProps): ReactElement | null {\n  if (isEmptySource(source)) {\n    /* istanbul ignore next */\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      console.warn(debugMessage.noSource);\n    }\n    return null;\n  }\n  if (isUriSource(source)) {\n    return React.createElement(SourceLoaderUri, { source, ...props });\n  }\n  if (isDomSource(source)) {\n    return React.createElement(SourceLoaderDom, { source, ...props });\n  }\n  return React.createElement(SourceLoaderInline, { source, ...props });\n}\n\n// check if for each key of two objects, the values are equal\nfunction shallowEqual(prop1: any, prop2: any) {\n  if (!equals(Object.keys(prop1), Object.keys(prop2))) {\n    return false;\n  }\n  for (const key in prop1) {\n    if (prop1[key] !== prop2[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * A React component to render HTML snippets.\n *\n * @remarks This component is useful when you have to load dozens of HTML\n * snippets with the same config. Performance is expected to improve in such\n * scenarios.\n *\n * @warning This component requires to have {@link TRenderEngineProvider}\n * and {@link RenderHTMLConfigProvider} as parents.\n */\nconst RenderHTMLSource = memo(\n  function RenderHtmlSource({\n    onDocumentMetadataLoaded,\n    onTTreeChange,\n    contentWidth,\n    ...props\n  }: RenderHTMLSourceProps) {\n    const profile = useProfiler({\n      prop: 'onDocumentMetadataLoaded or onTTreeChange'\n    });\n    const ttreeEvents: TTreeEvents = useMemo(() => {\n      typeof __DEV__ === 'boolean' && __DEV__ && profile();\n      return {\n        onDocumentMetadataLoaded,\n        onTTreeChange\n      };\n    }, [onDocumentMetadataLoaded, onTTreeChange, profile]);\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      if (!(typeof contentWidth === 'number')) {\n        console.warn(debugMessage.contentWidth);\n      }\n    }\n    return (\n      <ttreeEventsContext.Provider value={ttreeEvents}>\n        <contentWidthContext.Provider\n          value={contentWidth || Dimensions.get('window').width}>\n          {React.createElement(RawSourceLoader, props)}\n        </contentWidthContext.Provider>\n      </ttreeEventsContext.Provider>\n    );\n  },\n  ({ source: prevSource, ...prev }, { source: currSource, ...curr }) => {\n    return shallowEqual(prevSource, currSource) && shallowEqual(prev, curr);\n  }\n);\n\n/**\n * @ignore\n */\n(RenderHTMLSource as any).propTypes = renderSourcePropTypes;\n\nexport default RenderHTMLSource;\n"]},"metadata":{},"sourceType":"script"}