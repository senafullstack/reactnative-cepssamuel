{"ast":null,"code":"\"use strict\";var _defineProperty=require(\"@babel/runtime/helpers/defineProperty\");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=buildTREFromConfig;var _transientRenderEngine=_interopRequireDefault(require(\"@native-html/transient-render-engine\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function buildTREFromConfig(props){var allowedStyles=props.allowedStyles,_props$ignoredStyles=props.ignoredStyles,ignoredStyles=_props$ignoredStyles===void 0?[]:_props$ignoredStyles,ignoredDomTags=props.ignoredDomTags,ignoreDomNode=props.ignoreDomNode,domVisitors=props.domVisitors,htmlParserOptions=props.htmlParserOptions,baseStyle=props.baseStyle,classesStyles=props.classesStyles,tagsStyles=props.tagsStyles,idsStyles=props.idsStyles,enableCSSInlineProcessing=props.enableCSSInlineProcessing,enableUserAgentStyles=props.enableUserAgentStyles,_props$systemFonts=props.systemFonts,systemFonts=_props$systemFonts===void 0?[]:_props$systemFonts,_props$fallbackFonts=props.fallbackFonts,fallbackFonts=_props$fallbackFonts===void 0?{}:_props$fallbackFonts,_props$customHTMLElem=props.customHTMLElementModels,customHTMLElementModels=_props$customHTMLElem===void 0?{}:_props$customHTMLElem,emSize=props.emSize,setMarkersForTNode=props.setMarkersForTNode,selectDomRoot=props.selectDomRoot,dangerouslyDisableHoisting=props.dangerouslyDisableHoisting,dangerouslyDisableWhitespaceCollapsing=props.dangerouslyDisableWhitespaceCollapsing;var customizeHTMLModels=Object.keys(customHTMLElementModels).length?function(defaultModels){return _objectSpread(_objectSpread({},defaultModels),customHTMLElementModels);}:undefined;var fontMap={};systemFonts.forEach(function(font){fontMap[font]=true;});var isFontSupported=function isFontSupported(fontFamily){if(fallbackFonts[fontFamily]){return fallbackFonts[fontFamily];}return fontMap[fontFamily]||false;};return new _transientRenderEngine.default({customizeHTMLModels:customizeHTMLModels,cssProcessorConfig:{isFontSupported:isFontSupported,inlinePropertiesBlacklist:ignoredStyles,inlinePropertiesWhitelist:allowedStyles,rootFontSize:emSize},htmlParserOptions:_objectSpread({decodeEntities:true},htmlParserOptions),stylesConfig:{baseStyle:baseStyle,enableCSSInlineProcessing:enableCSSInlineProcessing,enableUserAgentStyles:enableUserAgentStyles,classesStyles:classesStyles,idsStyles:idsStyles,tagsStyles:tagsStyles},ignoredDomTags:ignoredDomTags,ignoreDomNode:ignoreDomNode,domVisitors:domVisitors,setMarkersForTNode:setMarkersForTNode,selectDomRoot:selectDomRoot,dangerouslyDisableHoisting:dangerouslyDisableHoisting,dangerouslyDisableWhitespaceCollapsing:dangerouslyDisableWhitespaceCollapsing});}","map":{"version":3,"sources":["buildTREFromConfig.ts"],"names":["ignoredStyles","systemFonts","fallbackFonts","customHTMLElementModels","dangerouslyDisableWhitespaceCollapsing","customizeHTMLModels","defaultModels","fontMap","font","isFontSupported","fontFamily","TRenderEngine","cssProcessorConfig","inlinePropertiesBlacklist","inlinePropertiesWhitelist","rootFontSize","emSize","htmlParserOptions","decodeEntities","stylesConfig","baseStyle","enableCSSInlineProcessing","enableUserAgentStyles","classesStyles","idsStyles","tagsStyles","ignoredDomTags","ignoreDomNode","domVisitors","setMarkersForTNode","selectDomRoot","dangerouslyDisableHoisting"],"mappings":"48BACA,GAAA,CAAA,sBAAA,CAAA,sBAAA,CAAA,OAAA,CAAA,sCAAA,CAAA,CAAA,C,mFAae,QAAA,CAAA,kBAAA,CAAA,KAAA,CAAwD,CACrE,GAAM,CAAA,aAAN,CAAA,KAAA,CAAM,aAAN,sBAAA,KAAA,CAGEA,aAHF,CAGEA,aAHF,+BAAM,EAAN,sBAAM,cAAN,CAAA,KAAA,CAAM,cAAN,CAAM,aAAN,CAAA,KAAA,CAAM,aAAN,CAAM,WAAN,CAAA,KAAA,CAAM,WAAN,CAAM,iBAAN,CAAA,KAAA,CAAM,iBAAN,CAAM,SAAN,CAAA,KAAA,CAAM,SAAN,CAAM,aAAN,CAAA,KAAA,CAAM,aAAN,CAAM,UAAN,CAAA,KAAA,CAAM,UAAN,CAAM,SAAN,CAAA,KAAA,CAAM,SAAN,CAAM,yBAAN,CAAA,KAAA,CAAM,yBAAN,CAAM,qBAAN,CAAA,KAAA,CAAM,qBAAN,oBAAA,KAAA,CAcEC,WAdF,CAcEA,WAdF,6BAAM,EAAN,yCAAA,KAAA,CAeEC,aAfF,CAeEA,aAfF,+BAAM,EAAN,4CAAA,KAAA,CAgBEC,uBAhBF,CAgBEA,uBAhBF,gCAAM,EAAN,uBAAM,MAAN,CAAA,KAAA,CAAM,MAAN,CAAM,kBAAN,CAAA,KAAA,CAAM,kBAAN,CAAM,aAAN,CAAA,KAAA,CAAM,aAAN,CAAM,0BAAN,CAAA,KAAA,CAAM,0BAAN,CAqBEC,sCArBF,CAAA,KAAA,CAqBEA,sCArBF,CAuBA,GAAMC,CAAAA,mBAAmB,CAAG,MAAM,CAAN,IAAA,CAAA,uBAAA,EAAA,MAAA,CACvBC,SAAAA,aAAD,CAAuE,CACrE,sCAAO,aAAP,EAA8BH,uBAA9B,EAFsB,CAAA,CAA5B,SAAA,CAKA,GAAMI,CAAAA,OAAO,CAAb,EAAA,CACAN,WAAW,CAAXA,OAAAA,CAAqBO,SAAAA,IAAD,CAAU,CAC5BD,OAAO,CAAPA,IAAO,CAAPA,CAAAA,IAAAA,CADFN,CAAAA,EAGA,GAAMQ,CAAAA,eAAe,CAAIC,QAAnBD,CAAAA,eAAmBC,CAAAA,UAAD,CAAwB,CAC9C,GAAIR,aAAa,CAAjB,UAAiB,CAAjB,CAA6D,CAC3D,MAAOA,CAAAA,aAAa,CAApB,UAAoB,CAApB,CACD,CAED,MAAOK,CAAAA,OAAO,CAAPA,UAAO,CAAPA,EAAP,KAAA,CALF,CAAA,CAOA,MAAO,IAAII,CAAAA,sBAAAA,CAAJ,OAAA,CAAkB,CACvBN,mBADuB,CACvBA,mBADuB,CAEvBO,kBAAkB,CAAE,CAClBH,eADkB,CAClBA,eADkB,CAElBI,yBAAyB,CAFP,aAAA,CAGlBC,yBAAyB,CAHP,aAAA,CAIlBC,YAAY,CAAEC,MAJI,CAFG,CAQvBC,iBAAiB,gBACfC,cAAc,CADG,IAAF,EAEZD,iBAFY,CARM,CAYvBE,YAAY,CAAE,CACZC,SADY,CACZA,SADY,CAEZC,yBAFY,CAEZA,yBAFY,CAGZC,qBAHY,CAGZA,qBAHY,CAIZC,aAJY,CAIZA,aAJY,CAKZC,SALY,CAKZA,SALY,CAMZC,UAAAA,CAAAA,UANY,CAZS,CAoBvBC,cApBuB,CAoBvBA,cApBuB,CAqBvBC,aArBuB,CAqBvBA,aArBuB,CAsBvBC,WAtBuB,CAsBvBA,WAtBuB,CAuBvBC,kBAvBuB,CAuBvBA,kBAvBuB,CAwBvBC,aAxBuB,CAwBvBA,aAxBuB,CAyBvBC,0BAzBuB,CAyBvBA,0BAzBuB,CA0BvB3B,sCAAAA,CAAAA,sCA1BuB,CAAlB,CAAP,CA4BD","sourcesContent":["import { TRenderEngineConfig } from '../shared-types';\nimport TRenderEngine, {\n  HTMLModelRecord,\n  TagName\n} from '@native-html/transient-render-engine';\n\n/**\n * Build a {@link TRenderEngine} instance from a configuration object.\n *\n * @remarks This utility can be useful to test and debug the TRE layer of your\n * application.\n *\n * @param props - The configuration from which a TRE should be built.\n */\nexport default function buildTREFromConfig(props: TRenderEngineConfig) {\n  const {\n    allowedStyles,\n    // TODO fix upstream\n    ignoredStyles = [],\n    ignoredDomTags,\n    ignoreDomNode,\n    domVisitors,\n    htmlParserOptions,\n    baseStyle,\n    classesStyles,\n    tagsStyles,\n    idsStyles,\n    enableCSSInlineProcessing,\n    enableUserAgentStyles,\n    systemFonts = [],\n    fallbackFonts = {},\n    customHTMLElementModels = {},\n    emSize,\n    setMarkersForTNode,\n    selectDomRoot,\n    dangerouslyDisableHoisting,\n    dangerouslyDisableWhitespaceCollapsing\n  } = props;\n  const customizeHTMLModels = Object.keys(customHTMLElementModels).length\n    ? (defaultModels: HTMLModelRecord<TagName>): HTMLModelRecord<TagName> => {\n        return { ...defaultModels, ...customHTMLElementModels };\n      }\n    : undefined;\n  const fontMap = {} as Record<string, true>;\n  systemFonts.forEach((font) => {\n    fontMap[font] = true;\n  });\n  const isFontSupported = (fontFamily: string) => {\n    if (fallbackFonts[fontFamily as keyof typeof fallbackFonts]) {\n      return fallbackFonts[fontFamily as keyof typeof fallbackFonts];\n    }\n    /* istanbul ignore next */\n    return fontMap[fontFamily] || false;\n  };\n  return new TRenderEngine({\n    customizeHTMLModels,\n    cssProcessorConfig: {\n      isFontSupported,\n      inlinePropertiesBlacklist: ignoredStyles,\n      inlinePropertiesWhitelist: allowedStyles,\n      rootFontSize: emSize\n    },\n    htmlParserOptions: {\n      decodeEntities: true,\n      ...htmlParserOptions\n    },\n    stylesConfig: {\n      baseStyle,\n      enableCSSInlineProcessing,\n      enableUserAgentStyles,\n      classesStyles,\n      idsStyles,\n      tagsStyles\n    },\n    ignoredDomTags,\n    ignoreDomNode,\n    domVisitors,\n    setMarkersForTNode,\n    selectDomRoot,\n    dangerouslyDisableHoisting,\n    dangerouslyDisableWhitespaceCollapsing\n  });\n}\n"]},"metadata":{},"sourceType":"script"}